# プリクラ印刷レイアウトツール

プリクラ風の写真をL判、2L判、ハガキサイズの用紙にレイアウトして印刷できるWebアプリケーションです。

## 主な機能

### 完成済みの機能

1. **写真のアップロードと配置**
   - ドラッグ＆ドロップまたはタップで複数の写真をアップロード
   - 用紙サイズに応じて自動的に枠に配置
   - 写真の入れ替え（ドラッグ＆ドロップ）

2. **用紙サイズ選択**
   - L判（6枠）
   - 2L判（16枠）
   - ハガキ（9枠）
   - 各サイズ変更時にプレビュー表示

3. **写真編集（各写真の編集画面）**
   - ズーム調整（50%〜300%）
   - 90度単位の回転
   - ドラッグで位置調整
   - ピンチで拡大/縮小

4. **ロック機能（編集画面内）**
   - 写真の位置・ズームをロック
   - コメントの位置・サイズをロック
   - 誤操作防止のための機能

5. **コメント機能**
   - 各写真に個別のコメントを追加
   - コメントの位置をドラッグで調整
   - コメントのサイズをピンチで調整
   - 個別のフォント・サイズ・色設定

6. **日付機能**
   - EXIFから撮影日を自動取得
   - 手動での日付設定
   - 表示位置の選択（6箇所）
   - フォーマット選択（yyyy/mm/dd など）
   - 個別のフォント・サイズ・色設定

7. **切り取り線表示**
   - 切り取り線の表示/非表示
   - 線の太さ調整

8. **出力**
   - PNG形式でダウンロード
   - JPEG形式でダウンロード
   - 300dpi高解像度出力

9. **編集状態の保存・読み込み**
   - .pklayout形式でファイル保存
   - 保存したファイルからの復元
   - 自動キャッシュ保存（小さいサイズの場合）
   - ページ読み込み時にキャッシュからの復元確認

10. **その他**
    - レスポンシブデザイン（スマートフォン対応）
    - キーボードショートカット（Ctrl+S: 保存、Ctrl+O: 読み込み、Escape: モーダルを閉じる）
    - ヘルプガイド

## 使用方法

1. `index.html` をブラウザで開く
2. 用紙サイズを選択
3. 「写真をアップロード」エリアをタップまたは写真をドラッグ＆ドロップ
4. 写真をタップして編集（ズーム、回転、コメント追加など）
5. PNG または JPEG 形式でダウンロード
6. 印刷

## ファイル構成

```
index.html    - メインのHTMLファイル（CSS/JavaScript含む）
README.md     - このファイル
```

## 技術スタック

- HTML5
- CSS3
- JavaScript (ES6+)
- Fabric.js（Canvas操作ライブラリ）
- LZ-String（データ圧縮）
- Font Awesome（アイコン）
- Google Fonts（Noto Sans JP）

## 保存ファイル形式

`.pklayout` ファイルは以下の情報を含むLZString圧縮されたJSONデータです：
- バージョン情報
- 用紙サイズ
- 切り取り線設定
- コメント設定
- 日付設定
- 各画像データ（圧縮された画像、ズーム、回転、位置、コメントなど）

## 今後の改善案

- [ ] 複数ページ対応
- [ ] テンプレート機能
- [ ] クラウド保存対応
- [ ] 画像フィルター機能

## 更新履歴

### v2.1 (最新)
- ロック機能を各写真の編集画面内に移動
- コメント設定をトップ画面から削除（常に有効、個別設定のみ）
- 保存ファイルの形式をBase64圧縮に変更（互換性向上）
- .pklayoutファイルの読み込み問題を修正
- キャッシュ自動保存機能を追加
- ページ読み込み時のキャッシュ復元確認機能を追加

### v2.0
- 初回リリース
